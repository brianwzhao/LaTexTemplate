=TEX
\documentclass{ffslides}
\ffpage{25}{\numexpr 16/9}
\usepackage{ProofPower}
\usepackage{framed}
\usepackage{amsmath}

\newcommand{\hdng}{CS113 Lab 6: }

\begin{document}
\obeyspaces

\input{../src/template.tex}

\twoCol{Prependix A:a Setup}{
=SML
datatype SetElement = NoElem | Int of int| String of string | Set of set | Product of SetElement*SetElement
 and set = elems of SetElement list;

fun greaterSet(x:set,y:set) = false;

fun greaterElem(x:SetElement,y:SetElement) = (case x of
    Int x => (
      case y of Int y => x>y
        | _=> false)
  | String x => (
      case y of Int y => true
        | String y => x>y
        | _ => false)
  | Set x =>(
      case y of NoElem => false
        | Set y => greaterSet(x,y)
        | _ => true)
  | Product (a,b) =>(
      case y of NoElem => false
        | Product (c,d) => (if greaterElem(a,c) orelse greaterElem(c,a)
            then greaterElem(a,c)
            else greaterElem(b,d))
        | _ => true)
  | _ => true);

fun setArray(x) = case x of
  elems x => x;

fun merge(x:set, y:set) = case x of
   elems [] => y
 | elems (x::xs) => ( case y of
     elems [] => elems(x::xs)
   | elems(y::ys) => if greaterElem(x,y)
       then elems (y::(setArray (merge(elems (x::xs),elems ys))))
        else if greaterElem(y,x) then
          elems (x::(setArray (merge(elems xs,elems (y::ys)))))
          else elems (x::(setArray (merge(elems xs,elems ys))))
   );

fun inOrder(x) = case x of elems [] => true
 | elems(x::xs::xss)=> greaterElem(xs,x)
    andalso (inOrder(elems(xs::xss)))
 | elems(x::[])=>true;

fun sort(elems(x::xs)) =
  merge(elems [x],sort(elems xs))
 | sort(elems[]) = elems [];


val title = "Template definitions";
PolyML.print_depth 64;
(* Nested parameter builder *)
fun nas(a:'a,b:'a)(n:int):'a list list =
  let
    fun an(first,second,input) =
      ((map (fn a=> first::a) input)
      @ (map(fn a=>second::a)input))
  in
  if n = 1 then [[a],[b]]
  else an (a, b, (nas(a,b)(n-1)))
  end;
val na = nas(true,false);
fun uh(arr:bool*bool->bool)(a:bool list):bool
  = arr (List.nth(a,0), List.nth(a,1));
=TEX
}
{
=SML
fun &&(false,_)=false | &&(true,q)=q;
fun ||(false,q)=q | || (true,_)=true;
fun !(false)=true | !(true)=false;
fun xor(false,q)=q | xor(true,q)= !(q);
fun cond(p,q) = ||(! p,q);
val title = "Test Cases Slide A:a";
map (uh(||))(na(2));
map (uh(&&))(na(2));
map (uh(xor))(na(2));
map (uh(cond))(na(2));
infix &&; infix ||; infix xor; infix cond;
=TEX
}
\putfig{0.5}{0.75}{0.4}{../include/figA_a.eps}
\btext{0.85}{0.63}{0.1}{Output of the previous functions}

\twoCol{Prependix A:b SML "Proof" check}{
=SML
val title = "Slide A:c More Template";
fun taut ([]:bool list) = true | taut(a::b) = a andalso taut(b);
fun caseCheck(a:((bool list)->bool) list)
  (b:(bool list)->bool)(c:bool list) =
    if (not(b c))
      then
        not (taut (map (fn d:(bool list)->bool => d c) a))
      else true;
fun isValid(prop:(bool list->bool) list)(conc:(bool list->bool))
  = taut(map (caseCheck prop conc) (na 5));
=TEX
}
{
=SML
fun p(a:bool list) = List.nth(a,0);
fun q(a:bool list) = List.nth(a,1);
fun r(a:bool list) = List.nth(a,2);
fun s(a:bool list) = List.nth(a,3);
fun t(a:bool list) = List.nth(a,4);
val title = "Test Cases Slide A:b";
fun s1(a) = ! (p a) && (q a);
fun s2(a) = (r a)|| (p a);
isValid [s1,s2] r;
isValid [s1,s2] p;
=TEX
}
\putfig{0.05}{0.69}{0.4}{../include/figA_b.eps}
\btext{0.5}{0.7}{0.2}{With the assumptions $\sim p \land q $ and $r \lor p$ we see that $r$ is a valid conclusion and $p$ is not.}

\twoCol{Prependix B: Proof Power Predefinitions}
{
=DUMP lab.pp
val title = "Template Definition";
val subsection = "Distribution";
val dist_²_±_l = prove_rule []
  ¬µ a b c· c ² (a ± b) ¤ (c²a) ± (c²b) ®;
val dist_²_±_r = prove_rule []
  ¬µ a b c· (a ± b) ² c ¤ (a²c) ± (b²c) ®;
val dist_²_±_l_rev = prove_rule []
  ¬µ a b c· (c²a) ± (c²b) ¤ c ² (a ± b) ®;
val dist_²_±_r_rev = prove_rule []
  ¬µ a b c· (a²c) ± (b²c) ¤ (a ± b) ² c ®;
val dist_³_² = prove_rule []
  ¬µ a b·  ³ (a ² b) ¤ ³ a ± ³ b ®;
val dist_³_²_rev = prove_rule []
  ¬µ a b·  ³ a ± ³ b ¤ ³ (a ² b) ®;
=TEX
}
{
=DUMPMORE lab.pp
val dist_³_± = prove_rule []
  ¬µ a b·  ³ (a ± b) ¤ ³ a ² ³ b ®;
val dist_³_±_rev = prove_rule []
  ¬µ a b·  ³ a ² ³ b ¤ ³ (a ± b) ®;
val subsection = "Conversion";
val ´_thm = ´_thm;
val ´_thm_rev = prove_rule []
  ¬µ a b·  ³a ² b ¤ a ´ b ®;
=TEX
}

\twoCol{Prependix B:b Proof Power Predefinitions}
{
=DUMPMORE lab.pp
val premise = asm_rule;
val modus_ponens = ´_elim;
val modus_tollens = modus_tollens_rule;
val disjunctive_addition = ²_right_intro;
val conjunctive_addition = ±_intro;
val conjunctive_simplification = ±_right_elim;
val disjunctive_syllogism = ²_cancel_rule;
val hypothetical_syllogism = ´_trans_rule;
val double_negation = ³_³_elim;
=TEX
}
{
Only redefining things so no output to show.
}

\twoCol{Slide 1: Example 12.4}
{
Example 12.4:\\
Suppose that $A=\{2,4,6\}$, $B=\{2,6\}$, and $C = \{4,6\}$.  Determine which of these sets are subsets of which other(s) of these sets.
}
{
}

\twoCol{Slide 2: Example 12.6a}
{
Example 12.6:\\
Determine whether the following pair of sets is equal.\\
a) $\{1,3,5\}$ and $\{5,3,1\}$
}
{
}

\twoCol{Slide 3: Example 12.10}
{
Example 12.10:\\
Let $A = \{a,b,c\}$, $B = \{b,c,d\}$, and $C = \{b,c,e\}$.\\
a) Find $A\cup(B\cap C)$, $(A\cup B)\cap C$, and $(A\cup B) \cap(A\cup C)$. Which of these sets are equal?\\
a) Find $A\cap(B\cup C)$, $(A\cap B)\cup C$, and $(A\cap B) \cup(A\cap C)$. Which of these sets are equal?\\
a) Find $A\setminus (B\setminus C)$ and $(A\setminus B)\setminus C$. Are these sets are equal?\\
}
{
}

\twoCol{Slide 4: Example 12.12}
{
Example 12.12:\\
Find $A\triangle B$ if $A=\{1,3,5\}$ and $B = \{1,2,3\}$.
}
{
}

\twoCol{Slide 5: Example 12.13}
{
Example 12.13:\\
Let $A = \{x,y\}$, $B = \{1,2,3\}$, and $C = \{a,b\}$. Find\\
a) $A\times B\times C$\\
b) $(A\times B)\times C$
}
{
}

\twoCol{Slide 6: Problem 12.3}
{
Problem 12.3:\\
Which of the following sets are equal?\\
a) $\{a,b,c,d\}$\\
b) $\{d,e,a,c\}$\\
c) $\{d,b,a,c\}$\\
d) $\{a,a,d,e,c,e\}$
}
{
}

\twoCol{Slide 7: Problem 12.4}
{
Problem 12.4:\\
Let $A = \{c,d,f,g\}$,$B = \{f,i\}$, and $C = \{d,g\}$.  Answer each of the following questions.  Give reasons for your answers.\\
a) Is $B \subseteq A$?\\
b) Is $C \subseteq A$?\\
c) Is $C \subseteq C$?\\
d) Is $C$ a proper subset of $A$?
}
{
}

\twoCol{Slide 8: Problem 12.5(a,e,g,j)}
{
Problem 12.5:\\
a) Is $3\in\{1,2,3\}$?\\
e) Is $1\in\{1\}$?\\
g) Is $\{1\}\subseteq\{1,2\}$\\
j) Is $\{1\}\subseteq\{1\}$
}
{
}

\twoCol{Slide 9: Problem 12.6}
{
Problem 12.6:\\
Let $A = \{b,c,d,f,g\}$ and $B = \{a,b,c\}$.  Find each of the following:\\
a) $A\cup B$\\
b) $A\cap B$\\
c) $A\setminus B$\\
d) $B\setminus A$

}
{
}

\twoCol{Slide 10: Problem 12.8}
{
Problem 12.8:\\
Let $A = \{x,y,z,w\}$ and $B = \{a,b\}$. List the elements of each of the following sets:\\
a) $A\times B$\\
b) $B\times A$\\
c) $A\times A$\\
d) $B\times B$
}
{
}

\twoCol{Slide 11: Problem 12.9}
{
Problem 12.9:\\
a) Find all possible subsets of the set $A = \{a,b,c\}$.\\
b) How many proper subsets are there?
}
{
}

\twoCol{Slide 12: Problem 12.12}
{
Problem 12.12:\\
Let $A$ be the set of the first five composite numbers and $B$ be the set of positive integers less than or equal to 8.  Find $A\setminus B$ an $B\setminus A$.
}
{
}

\twoCol{Slide 13: Problem 12.14}
{
Problem 12.14:\\
Let $A$ be the set of natural numbers less than 0 and $B = \{1,3,7\}$. Find $A\cup B$ and $A\cap B$.
}
{
}

\twoCol{Slide 14: Problem 12.15}
{
Problem 12.15:\\
Let
$$ A = \{ x \in\mathbb{N} \mid 4 \leq x \leq 8 \} $$
$$ B = \{ x \in \mathbb{N} \mid x \hspace{10pt} even
\hspace{10pt} and \hspace{10pt} x \leq 10\}$$
Find $A\cup B$ and $A\cap B$
}
{
}

\end{document}
