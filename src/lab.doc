=TEX
\documentclass{ffslides}
\ffpage{25}{\numexpr 16/9}
\usepackage{ProofPower}
\usepackage{framed}
\usepackage{amsmath}

\newcommand{\hdng}{CS113 Lab 6: }

\begin{document}
\obeyspaces

\input{../src/template.tex}

\twoCol{Prependix A:a Setup}{
=SML
PolyML.print_depth 64;
datatype SetElement = NoElem
 | Int of int
 | String of string
 | Set of set
 | Product of SetElement*SetElement
 and set = elems of SetElement list;
fun greaterElem(x:SetElement,y:SetElement) =
let
  fun isEqual(x:SetElement,y:SetElement) =
    not (greaterElem(x,y) orelse greaterElem(y,x));
in
  let
    fun greaterSet(elems(x::xs),elems(y::ys)) =
      if isEqual (x,y)
=TEX
}
{
=SML
        then greaterSet(elems xs,elems ys)
        else greaterElem(x,y)
    | greaterSet(elems[],_) = false
    | greaterSet(_,elems []) = true;
  in
   (case x of
      Int x => (
        case y of Int y => x>y
          | _=> false)
    | String x => (
        case y of Int y => true
          | String y => x>y
          | _ => false)
=TEX
}

\twoCol{Prependix A:b Setup}
{
=SML
    | Set x =>(
        case y of NoElem => false
          | Set y => greaterSet(x,y)
          | _ => true)
    | Product (a,b) =>(
        case y of NoElem => false
          | Product (c,d) =>
              (if isEqual(a,c)
                then greaterElem(b,d)
                else greaterElem(a,c))
          | _ => true)
    | _ => true)
  end
end;
=TEX
}
{
=SML
fun isEqual(x:SetElement,y:SetElement) =
  not (greaterElem(x,y) orelse greaterElem(y,x));

fun greaterSet(elems(x::xs),elems(y::ys)) =
  if isEqual (x,y)
    then greaterSet(elems xs,elems ys)
    else greaterElem(x,y)
 | greaterSet(elems[],_) = false
 | greaterSet(_,elems []) = true;
=TEX
}

\twoCol{Prependix A:c Setup}
{
=SML
fun setArray(elems x) = x;

fun merge(x:set, y:set) = case x of
   elems [] => y
 | elems (x::xs) => ( case y of
     elems [] => elems(x::xs)
   | elems(y::ys) => if greaterElem(x,y)
      then elems (y::(setArray
        (merge(elems (x::xs),elems ys))))
      else if greaterElem(y,x)
        then
          elems (x::(setArray
            (merge(elems xs,elems (y::ys)))))
        else elems (x::(setArray (merge(elems xs,elems ys))))
   );
=TEX
}
{
=SML
fun inOrder(x) = case x of elems [] => true
 | elems(x::xs::xss)=> greaterElem(xs,x)
    andalso (inOrder(elems(xs::xss)))
 | elems(x::[])=>true;

fun sort(elems(x::xs)) = (case x of
  Set x =>merge(elems[Set(sort x)],sort(elems xs))
 | _ => merge(elems [x],sort(elems xs)))
 | sort(elems[]) = elems [];
=TEX
}

\twoCol{Slide B:a Operations}
{
=SML
fun elementOf(x, elems(y::ys)) =
  isEqual(x,y) orelse elementOf(x,elems ys)
 | elementOf(x,elems []) = false;
fun subsetEq(elems(x::xs),elems(y::ys)) =
  if isEqual(x,y)
    then subsetEq(elems xs,elems ys)
    else if greaterElem(x,y)
      then subsetEq(elems(x::xs),elems ys)
      else false
 | subsetEq(elems [],_) = true
 | subsetEq(_,_)=false;
fun subsetProp(x,y) = subsetEq(x,y) andalso
  not (subsetEq(y,x));
fun setEqual(x,y) = subsetEq(x,y) andalso
  subsetEq(y,x);
=TEX
}
{
=SML
fun intersect(elems(x::xs),elems(y::ys)) =
  if isEqual(x,y)
    then elems(x::(setArray(intersect(elems xs,elems ys))))
    else if greaterElem(x,y)
      then intersect(elems(x::xs),elems ys)
      else intersect(elems xs,elems(y::ys))
 | intersect(_,_) = elems [];
fun union(elems(x::xs),elems(y::ys)) =
  if isEqual(x,y)
    then elems(x::(setArray(union(elems xs,elems ys))))
    else if greaterElem(x,y)
      then elems(y::(setArray(union(elems(x::xs),elems ys))))
      else elems(x::(setArray(union(elems xs,elems(y::ys)))))
 | union(elems [],y) = y
 | union(x,elems []) = x;
=TEX
}

\twoCol{Prependix B:b Operations}
{
=SML
fun setMinus(elems(x::xs),elems(y::ys)) =
  if greaterElem(x,y)
    then setMinus(elems(x::xs),elems ys)
    else if greaterElem(y,x)
      then elems(x::(setArray
        (setMinus(elems xs,elems(y::ys)))))
      else setMinus(elems xs,elems ys)
 | setMinus(x,_) = x;
fun symDiff(elems(x::xs),elems(y::ys)) =
  if greaterElem(x,y)
    then elems(y::(setArray(symDiff(elems(x::xs),elems ys))))
    else if greaterElem(y,x)
      then elems(x::(setArray(symDiff(elems xs,elems(y::ys)))))
      else symDiff(elems xs,elems ys)
 | symDiff(elems [],y) = y | symDiff(x,elems []) = x;
=TEX
}
{
=SML
fun powSet(elems(x::xss)) =
  let
    fun again(a,elems(b::bs)) = (case b of
      Set(elems b) =>
        elems((Set(elems (a::b)))::
          (setArray(again(a,elems bs))))
       | _ => again(a,elems bs))
     | again(a,elems []) = elems [];
  in
    sort(merge(
      powSet(elems xss),
      again(x,powSet(elems xss))))
end
   | powSet(elems []) = elems[Set(elems [])];
=TEX
}

\twoCol{Prependix B:c Operations}
{
=SML
fun cartProd(elems(x::xs),elems(y::ys)) =
  elems((Product(x,y))::
    (setArray(merge(
      cartProd(elems(x::xs),elems ys),
      (cartProd(elems xs,elems(y::ys)))))))
 | cartProd(_,_) = elems [];
=TEX
}

\twoCol{Prependix C:a Test}
{
=SML
val a = elems[Int 1,Int 2];
val b = elems[Int 1,Int 3];
val c = elems[Int 1];
=TEX
}
{
=SML
elementOf(Int 2,a);
elementOf(Int 2,b);
subsetEq(a,a);
subsetEq(a,b);
subsetProp(a,a);
subsetProp(c,a);
setEqual(a,a);
setEqual(a,b);
cartProd(a,b);
intersect(a,b);
union(a,b);
setMinus(a,b);
symDiff(a,b);
powSet(a);
=TEX
}

\twoCol{Slide 1: Example 12.4}
{
Example 12.4:\\
Suppose that $A=\{2,4,6\}$, $B=\{2,6\}$, and $C = \{4,6\}$.  Determine which of these sets are subsets of which other(s) of these sets.
}
{
}

\twoCol{Slide 2: Example 12.6a}
{
Example 12.6:\\
Determine whether the following pair of sets is equal.\\
a) $\{1,3,5\}$ and $\{5,3,1\}$
}
{
}

\twoCol{Slide 3: Example 12.10}
{
Example 12.10:\\
Let $A = \{a,b,c\}$, $B = \{b,c,d\}$, and $C = \{b,c,e\}$.\\
a) Find $A\cup(B\cap C)$, $(A\cup B)\cap C$, and $(A\cup B) \cap(A\cup C)$. Which of these sets are equal?\\
a) Find $A\cap(B\cup C)$, $(A\cap B)\cup C$, and $(A\cap B) \cup(A\cap C)$. Which of these sets are equal?\\
a) Find $A\setminus (B\setminus C)$ and $(A\setminus B)\setminus C$. Are these sets are equal?\\
}
{
}

\twoCol{Slide 4: Example 12.12}
{
Example 12.12:\\
Find $A\triangle B$ if $A=\{1,3,5\}$ and $B = \{1,2,3\}$.
}
{
}

\twoCol{Slide 5: Example 12.13b}
{
Example 12.13:\\
Let $A = \{x,y\}$, $B = \{1,2,3\}$, and $C = \{a,b\}$. Find\\
b) $(A\times B)\times C$
}
{
}

\twoCol{Slide 6: Problem 12.3}
{
Problem 12.3:\\
Which of the following sets are equal?\\
a) $\{a,b,c,d\}$\\
b) $\{d,e,a,c\}$\\
c) $\{d,b,a,c\}$\\
d) $\{a,a,d,e,c,e\}$
}
{
}

\twoCol{Slide 7: Problem 12.4}
{
Problem 12.4:\\
Let $A = \{c,d,f,g\}$,$B = \{f,i\}$, and $C = \{d,g\}$.  Answer each of the following questions.  Give reasons for your answers.\\
a) Is $B \subseteq A$?\\
b) Is $C \subseteq A$?\\
c) Is $C \subseteq C$?\\
d) Is $C$ a proper subset of $A$?
}
{
}

\twoCol{Slide 8: Problem 12.5(a,e,g,j)}
{
Problem 12.5:\\
a) Is $3\in\{1,2,3\}$?\\
e) Is $1\in\{1\}$?\\
g) Is $\{1\}\subseteq\{1,2\}$\\
j) Is $\{1\}\subseteq\{1\}$
}
{
}

\twoCol{Slide 9: Problem 12.6}
{
Problem 12.6:\\
Let $A = \{b,c,d,f,g\}$ and $B = \{a,b,c\}$.  Find each of the following:\\
a) $A\cup B$\\
b) $A\cap B$\\
c) $A\setminus B$\\
d) $B\setminus A$

}
{
}

\twoCol{Slide 10: Problem 12.8}
{
Problem 12.8:\\
Let $A = \{x,y,z,w\}$ and $B = \{a,b\}$. List the elements of each of the following sets:\\
a) $A\times B$\\
b) $B\times A$\\
c) $A\times A$\\
d) $B\times B$
}
{
}

\twoCol{Slide 11: Problem 12.9}
{
Problem 12.9:\\
a) Find all possible subsets of the set $A = \{a,b,c\}$.\\
b) How many proper subsets are there?
}
{
}

\twoCol{Slide 12: Problem 12.12}
{
Problem 12.12:\\
Let $A$ be the set of the first five composite numbers and $B$ be the set of positive integers less than or equal to 8.  Find $A\setminus B$ an $B\setminus A$.
}
{
}

\twoCol{Slide 13: Problem 12.14}
{
Problem 12.14:\\
Let $A$ be the set of natural numbers less than 0 and $B = \{1,3,7\}$. Find $A\cup B$ and $A\cap B$.
}
{
}

\twoCol{Slide 14: Problem 12.15}
{
Problem 12.15:\\
Let
$$ A = \{ x \in\mathbb{N} \mid 4 \leq x \leq 8 \} $$
$$ B = \{ x \in \mathbb{N} \mid x \hspace{10pt} even
\hspace{10pt} and \hspace{10pt} x \leq 10\}$$
Find $A\cup B$ and $A\cap B$
}
{
}

\end{document}
